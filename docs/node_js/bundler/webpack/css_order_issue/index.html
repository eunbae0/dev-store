<!doctype html>
<html lang="ko" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-node_js/bundler/webpack/css_order_issue" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Deep dive into webpack CSS order issue | Dev Store</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/dev-store/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/dev-store/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/dev-store/docs/node_js/bundler/webpack/css_order_issue"><meta data-rh="true" property="og:locale" content="ko"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Deep dive into webpack CSS order issue | Dev Store"><meta data-rh="true" name="description" content="해당 글을 번역 및 정리한 글입니다."><meta data-rh="true" property="og:description" content="해당 글을 번역 및 정리한 글입니다."><link data-rh="true" rel="icon" href="/dev-store/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/dev-store/docs/node_js/bundler/webpack/css_order_issue"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/dev-store/docs/node_js/bundler/webpack/css_order_issue" hreflang="ko"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/dev-store/docs/node_js/bundler/webpack/css_order_issue" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VQ918MY245"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-VQ918MY245",{anonymize_ip:!0})</script><link rel="stylesheet" href="/dev-store/assets/css/styles.d72ae124.css">
<script src="/dev-store/assets/js/runtime~main.219dde65.js" defer="defer"></script>
<script src="/dev-store/assets/js/main.e4925298.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_pa9R" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dev-store/"><div class="navbar__logo"><img src="/dev-store/img/logo.svg" alt="My Site Logo" class="themedComponent_c8AR themedComponent--light_Qnfw"><img src="/dev-store/img/logo.svg" alt="My Site Logo" class="themedComponent_c8AR themedComponent--dark_HpBT"></div><b class="navbar__title text--truncate">Dev Store</b></a><a class="navbar__item navbar__link" href="/dev-store/docs/fe/intro">FE</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dev-store/docs/node_js/intro">Node.js</a><a class="navbar__item navbar__link" href="/dev-store/docs/react_native/intro">RN</a><a class="navbar__item navbar__link" href="/dev-store/docs/ios/intro">iOS</a><a class="navbar__item navbar__link" href="/dev-store/docs/android/intro">Android</a><a class="navbar__item navbar__link" href="/dev-store/docs/rust/intro">Rust</a><a class="navbar__item navbar__link" href="/dev-store/docs/cs/intro">CS</a><a class="navbar__item navbar__link" href="/dev-store/docs/books/intro">Books</a><a class="navbar__item navbar__link" href="/dev-store/docs/category/git">ETC</a></div><div class="navbar__items navbar__items--right"><div class="toggle_oExt colorModeToggle_L_az"><button class="clean-btn toggleButton_Guh_ toggleButtonDisabled_vipt" type="button" disabled="" title="어두운 모드와 밝은 모드 전환하기 (현재 어두운 모드)" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 어두운 모드)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_jUga"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_xago"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_DQpm"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_DAWZ"><div class="docsWrapper_znQW"><button aria-label="맨 위로 스크롤하기" class="clean-btn theme-back-to-top-button backToTopButton_tora" type="button"></button><div class="docRoot_kIkk"><aside class="theme-doc-sidebar-container docSidebarContainer_xAwd"><div class="sidebarViewport_LADL"><div class="sidebar_yJt3"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_CMxW"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dev-store/docs/node_js/intro">Node.js Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/dev-store/docs/node_js/bundler/rsbuild/toolChain">bundler</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/dev-store/docs/node_js/bundler/rsbuild/toolChain">rsbuild</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/dev-store/docs/node_js/bundler/webpack/css_order_issue">webpack</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dev-store/docs/node_js/bundler/webpack/css_order_issue">Deep dive into webpack CSS order issue</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dev-store/docs/node_js/engine/v8_engine">engine</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/dev-store/docs/node_js/package_manager/corepack">package_manager</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_Uk3X"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_t0na"><div class="docItemContainer_qUef"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_oV2u" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="홈" class="breadcrumbs__link" href="/dev-store/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YDaz"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">bundler</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">webpack</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Deep dive into webpack CSS order issue</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_GVer theme-doc-toc-mobile tocMobile_KW2S"><button type="button" class="clean-btn tocCollapsibleButton_wsaA">이 페이지에서</button></div><div class="theme-doc-markdown markdown"><h1>Deep dive into webpack CSS order issue</h1>
<div class="theme-admonition theme-admonition-info admonition_hTIi alert alert--info"><div class="admonitionHeading_Ash5"><span class="admonitionIcon_VaQe"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>정보</div><div class="admonitionContent_VuPo"><p><a href="https://github.com/orgs/web-infra-dev/discussions/12" target="_blank" rel="noopener noreferrer">해당 글</a>을 번역 및 정리한 글입니다.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_OaXV" id="서문">서문<a href="#서문" class="hash-link" aria-label="서문에 대한 직접 링크" title="서문에 대한 직접 링크">​</a></h2>
<p>많은 사람들이 Webpack에서 CSS의 순서가 예상과 다르게 동작해 스타일이 올바르게 적용되지 않는 문제를 겪고 있다고 보고합니다. 사실 Webpack에서 CSS의 순서는 splitChunks 설정과 관련이 있으며, 매우 불안정합니다. 예를 들어, JS 모듈이 <code>a.css</code>를 먼저 import한 후 <code>b.css</code>를 import하더라도, <strong><code>splitChunks</code>를 설정하면 최종적으로 a와 b의 순서가 import 순서와 완전히 다를 수 있습니다.</strong></p>
<h2 class="anchor anchorWithStickyNavbar_OaXV" id="간단한-예시">간단한 예시<a href="#간단한-예시" class="hash-link" aria-label="간단한 예시에 대한 직접 링크" title="간단한 예시에 대한 직접 링크">​</a></h2>
<p>우선 아래 코드를 살펴보겠습니다.</p>
<div class="language-js codeBlockContainer_VICF theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_crbL"><pre tabindex="0" class="prism-code language-js codeBlock_XKjH thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_ZgUb"><span class="token-line" style="color:#F8F8F2"><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./a.css&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// a.css: body { background: red }</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./b.css&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// b.css: body { background: blue }</span><br></span></code></pre><div class="buttonGroup_gClz"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_KJW_" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_plNk"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_PQmj"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>위 코드는 JS 파일에서 <code>a.css</code>를 먼저 import하여 브라우저 배경색을 빨간색으로 변경한 후, <code>b.css</code>를 import하여 배경색을 파란색으로 변경합니다.</p>
<p>이 시점에서 우리의 경험에 따르면 최종 페이지는 <strong>파란색</strong>이 되어야 합니다. 왜냐하면 <code>b.css</code>가 <code>a.css</code>의 스타일을 덮어쓰기 때문입니다.</p>
<p>실제로 이 상태에서는 결과가 파란색입니다.</p>
<h3 class="anchor anchorWithStickyNavbar_OaXV" id="splitchunks-설정-후의-변화"><code>SplitChunks</code> 설정 후의 변화<a href="#splitchunks-설정-후의-변화" class="hash-link" aria-label="splitchunks-설정-후의-변화에 대한 직접 링크" title="splitchunks-설정-후의-변화에 대한 직접 링크">​</a></h3>
<p>이제 <code>splitChunks</code>를 구성하여 <code>a.css</code>와 <code>b.css</code>를 서로 다른 Chunk로 분리해 보겠습니다.</p>
<p>우리는 CSS 처리를 위해 <code>mini-css-extract-plugin</code>을 사용하고, <code>splitChunks</code>를 구성하여 두 파일을 별도의 Chunk로 분리합니다.</p>
<div class="language-js codeBlockContainer_VICF theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_crbL"><pre tabindex="0" class="prism-code language-js codeBlock_XKjH thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_ZgUb"><span class="token-line" style="color:#F8F8F2"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">splitChunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">minSize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">chunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;all&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">cacheGroups</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">a</span><span class="token regex regex-source language-regex special-escape escape">\.</span><span class="token regex regex-source language-regex">css</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token literal-property property">b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">b</span><span class="token regex regex-source language-regex special-escape escape">\.</span><span class="token regex regex-source language-regex">css</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup_gClz"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_KJW_" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_plNk"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_PQmj"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>이 구성을 사용해 다시 빌드하고 페이지를 열어보면, <strong>기적적으로 페이지가 빨간색으로 변</strong>하는 것을 발견하게 됩니다.</p>
<h3 class="anchor anchorWithStickyNavbar_OaXV" id="왜-이런-일이-발생할까요">왜 이런 일이 발생할까요?<a href="#왜-이런-일이-발생할까요" class="hash-link" aria-label="왜 이런 일이 발생할까요?에 대한 직접 링크" title="왜 이런 일이 발생할까요?에 대한 직접 링크">​</a></h3>
<p>이 문제는 Webpack에서 <code>splitChunks</code> 설정으로 인해 CSS 파일의 로드 순서가 변경되면서 발생합니다. 초기 import 순서는 유지되지 않고, 최종적으로 만들어진 Chunk 그룹의 순서에 따라 CSS가 로드되기 때문에 예상과 다른 결과가 나타날 수 있습니다.</p>
<h4 class="anchor anchorWithStickyNavbar_OaXV" id="추가-예제">추가 예제<a href="#추가-예제" class="hash-link" aria-label="추가 예제에 대한 직접 링크" title="추가 예제에 대한 직접 링크">​</a></h4>
<p>이 문제를 더   명확히 보여주기 위해, Webpack의 CSS 순서 불확실성을 설명하기 위해 핵심 팀 멤버 중 한 명인 <strong>ahabhgk</strong>가 만든 <a href="https://github.com/ahabhgk" target="_blank" rel="noopener noreferrer">GitHub 리포지토리</a>가 있습니다. 위 코드도 이 리포지토리에서 가져온 예제입니다.</p>
<p>이 리포지토리를 참고하면 splitChunks로 인해 CSS의 순서가 얼마나 불안정해질 수 있는지 다양한 사례로 확인할 수 있습니다.</p>
<h3 class="anchor anchorWithStickyNavbar_OaXV" id="webpack-css--splitchunks-red-or-blue">webpack css + splitChunks: red or blue?<a href="#webpack-css--splitchunks-red-or-blue" class="hash-link" aria-label="webpack css + splitChunks: red or blue?에 대한 직접 링크" title="webpack css + splitChunks: red or blue?에 대한 직접 링크">​</a></h3>
<p>다음으로, 해당 예시를 설명하겠습니다.</p>
<table><thead><tr><th>No.</th><th>import</th><th>css</th><th>splitChunks chunks</th><th>splitChunks priority</th><th>color</th></tr></thead><tbody><tr><td>0</td><td>style-loader</td><td>static</td><td>all</td><td>a = b</td><td>blue</td></tr><tr><td>1</td><td>style-loader</td><td>static</td><td>all</td><td>a &gt; b</td><td>blue</td></tr><tr><td>2</td><td>style-loader</td><td>static</td><td>all</td><td>a &lt; b</td><td>blue</td></tr><tr><td>3</td><td>style-loader</td><td>static</td><td>async</td><td>a = b</td><td>blue</td></tr><tr><td>4</td><td>style-loader</td><td>static</td><td>async</td><td>a &gt; b</td><td>blue</td></tr><tr><td>5</td><td>style-loader</td><td>static</td><td>async</td><td>a &lt; b</td><td>blue</td></tr><tr><td>6</td><td>style-loader</td><td>dynamic</td><td>all</td><td>a = b</td><td>blue</td></tr><tr><td>7</td><td>style-loader</td><td>dynamic</td><td>all</td><td>a &gt; b</td><td>blue</td></tr><tr><td>8</td><td>style-loader</td><td>dynamic</td><td>all</td><td>a &lt; b</td><td>blue</td></tr><tr><td>9</td><td>style-loader</td><td>dynamic</td><td>async</td><td>a = b</td><td>blue</td></tr><tr><td>10</td><td>style-loader</td><td>dynamic</td><td>async</td><td>a &gt; b</td><td>blue</td></tr><tr><td>11</td><td>style-loader</td><td>dynamic</td><td>async</td><td>a &lt; b</td><td>blue</td></tr><tr><td>12</td><td>experiments</td><td>static</td><td>all</td><td>a = b</td><td>red</td></tr><tr><td>13</td><td>experiments</td><td>static</td><td>all</td><td>a &gt; b</td><td>blue</td></tr><tr><td>14</td><td>experiments</td><td>static</td><td>all</td><td>a &lt; b</td><td>red</td></tr><tr><td>15</td><td>experiments</td><td>static</td><td>async</td><td>a = b</td><td>blue</td></tr><tr><td>16</td><td>experiments</td><td>static</td><td>async</td><td>a &gt; b</td><td>blue</td></tr><tr><td>17</td><td>experiments</td><td>static</td><td>async</td><td>a &lt; b</td><td>blue</td></tr><tr><td>18</td><td>experiments</td><td>dynamic</td><td>all</td><td>a = b</td><td>red</td></tr><tr><td>19</td><td>experiments</td><td>dynamic</td><td>all</td><td>a &gt; b</td><td>blue</td></tr><tr><td>20</td><td>experiments</td><td>dynamic</td><td>all</td><td>a &lt; b</td><td>red</td></tr><tr><td>21</td><td>experiments</td><td>dynamic</td><td>async</td><td>a = b</td><td>red</td></tr><tr><td>22</td><td>experiments</td><td>dynamic</td><td>async</td><td>a &gt; b</td><td>blue</td></tr><tr><td>23</td><td>experiments</td><td>dynamic</td><td>async</td><td>a &lt; b</td><td>red</td></tr></tbody></table>
<p>해당 테이블에서, 마지막 페이지에서 색상이 <code>blue</code> 혹은 <code>red</code>로 표시되는 지 쉽게 알 수 없습니다.</p>
<ul>
<li><code>import</code>는 어떻게 CSS가 handle되는지를 보여줍니다. <code>style-loader</code>, <code>mini-css-extract-plugin</code>, <code>Webpack의 기본 기능인 experiments.css</code> 옵션이 있습니다.</li>
<li><code>CSS</code>는 어떻게 <code>style.js</code>파일이 entry file에 의해 import되는지를 보여줍니다.<!-- -->
<ul>
<li>static: <code>import &#x27;./shared/style.js</code></li>
<li>dynamic: <code>import(&#x27;./shared/style.js&#x27;)</code></li>
</ul>
</li>
<li><code>splitChunks.chunks</code>는 어떤 chunks가 분할될지를 결정합니다.<!-- -->
<ul>
<li><code>all</code>: 어떤 chunk든 분할이 가능합니다.</li>
<li><code>async</code>: 오직 dynamic imports로 생성된 chunks만 분할됩니다.</li>
</ul>
</li>
<li><code>splitChunks.priority</code>는 <code>splitChunks의 cacheGrouops</code>의 우선순위를 결정합니다.</li>
<li><code>Color</code>는 마지막 페이지의 색상을 보여줍니다. <code>red</code>혹은<code>blue</code>입니다.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_OaXV" id="선행-지식-css-processing-methods-css-처리-방식">선행 지식: CSS Processing Methods (CSS 처리 방식)<a href="#선행-지식-css-processing-methods-css-처리-방식" class="hash-link" aria-label="선행 지식: CSS Processing Methods (CSS 처리 방식)에 대한 직접 링크" title="선행 지식: CSS Processing Methods (CSS 처리 방식)에 대한 직접 링크">​</a></h3>
<p>Webpack에서는 CSS 파일을 처리하는 데 일반적으로 세 가지 방법이 사용됩니다.</p>
<ul>
<li><code>style-loader</code> + <code>css-loader</code></li>
<li><code>mini-css-extract-webpack-plugin</code> + <code>css-loader</code></li>
<li><code>experiments.css</code></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_OaXV" id="css-loader">css-loader<a href="#css-loader" class="hash-link" aria-label="css-loader에 대한 직접 링크" title="css-loader에 대한 직접 링크">​</a></h4>
<p>css-loader에는 PostCSS가 내장되어 있습니다. 이 로더의 목적은 CSS 문법을 파싱하고 CSS 모듈을 처리하는 것입니다.
CSS 문자열을 받아들여 JS 문자열을 반환하며, 여기에는 CSS 내용, CSS 모듈 이름에 대한 매핑 등이 포함됩니다.</p>
<h4 class="anchor anchorWithStickyNavbar_OaXV" id="style-loader">style-loader<a href="#style-loader" class="hash-link" aria-label="style-loader에 대한 직접 링크" title="style-loader에 대한 직접 링크">​</a></h4>
<p>style-loader는 CSS를 페이지에 삽입하는 데 사용됩니다. 이 loader는 <strong>런타임에 style tag를 생성</strong>하고 이를 통해 CSS를 페이지에 삽입합니다.
CSS 삽입 순서는 <strong>import 순서와 완전히 일치</strong>하므로, style-loader를 사용하면 최종 페이지의 색상이나 스타일이 항상 안정적이고 예측 가능한 상태를 유지합니다. 예를 들어, 위 예시에서는 최종 색상이 항상 <code>blue</code>로 표시됩니다.</p>
<h4 class="anchor anchorWithStickyNavbar_OaXV" id="mini-css-extract-plugin">mini-css-extract-plugin<a href="#mini-css-extract-plugin" class="hash-link" aria-label="mini-css-extract-plugin에 대한 직접 링크" title="mini-css-extract-plugin에 대한 직접 링크">​</a></h4>
<p>이 플러그인은 런타임에 동적으로 style 태그를 삽입하는 <code>style-loader</code>와 달리, <strong>패키징 시 CSS 파일을 Chunk로 병합</strong>하고 <strong>최종적으로 산출물에 출력</strong>합니다.</p>
<h4 class="anchor anchorWithStickyNavbar_OaXV" id="experimentscss">experiments.css<a href="#experimentscss" class="hash-link" aria-label="experiments.css에 대한 직접 링크" title="experiments.css에 대한 직접 링크">​</a></h4>
<p>Webpack의 자체 CSS 처리 기능입니다. built-in support이며, 활성화하면 <strong>CSS가 Webpack에서 first-citizen처럼 다뤄집니다.</strong> 또한 personalized package splitting도 지원합니다.</p>
<h3 class="anchor anchorWithStickyNavbar_OaXV" id="splitchunks">SplitChunks?<a href="#splitchunks" class="hash-link" aria-label="SplitChunks?에 대한 직접 링크" title="SplitChunks?에 대한 직접 링크">​</a></h3>
<p>Code Splitting(코드 분할)과 <strong>splitChunks</strong>를 구분하는 것이 중요합니다.
Code Splitting은 Webpack의 기본 기능으로, <code>import(&#x27;package&#x27;)</code>문을 사용하여 특정 module을 새로운 Chunk로 이동시킵니다. <strong>splitChunks 설정은 code splitting strategy에 영향을 주지 않습니다.</strong>
splitChunks는 본질적으로 코드 분할로 생성된 Chunk를 <strong>추가로 분할</strong>하는 작업입니다.</p>
<h4 class="anchor anchorWithStickyNavbar_OaXV" id="chunk-group">Chunk Group<a href="#chunk-group" class="hash-link" aria-label="Chunk Group에 대한 직접 링크" title="Chunk Group에 대한 직접 링크">​</a></h4>
<p>Webpack에는 Chunk Group이라는 개념이 있습니다.
<code>maxRequest</code>를 사용자 정의하여 브라우저가 한 번에 요청할 수 있는 Chunk 수, 즉 ChunkGroup이 포함할 수 있는 Chunk 수를 제어할 수 있습니다.</p>
<p>코드 분할 후 여러 Chunk가 생성되며, 각 Chunk는 하나의 ChunkGroup에 대응됩니다.
splitChunks는 Chunk를 더 작은 여러 Chunk로 분할하여 그룹을 형성하고 그룹 단위로 로드하는 기능을 제공합니다. 예를 들어, HTTP/2 환경에서는 하나의 Chunk를 최대 20개의 Chunk로 나눠 동시에 로드할 수 있습니다.</p>
<p>Webpack에서는 JavaScript 모듈의 로드(loading)와 실행(execution)이 두 개의 별도 단계로 구분됩니다. 동일한 모듈이 여러 Chunk에 포함될 수 있지만, 실행은 한 번만 이루어집니다. 따라서 특정 모듈을 Chunk에서 분리하여 새로운 Chunk를 생성하는 작업을 자유롭게 수행할 수 있습니다.</p>
<p>반면, Rollup이나 Esbuild와 같은 가벼운 런타임 빌드 도구는 코드 분할 기능을 제공하지만, 생성된 산출물은 로드 시 즉시 실행됩니다. 이로 인해 Webpack에 비해 Chunk를 분리하는 유연성이 다소 제한됩니다.</p>
<h2 class="anchor anchorWithStickyNavbar_OaXV" id="the-principle-of-css-order-instablility">The Principle of CSS Order instablility<a href="#the-principle-of-css-order-instablility" class="hash-link" aria-label="The Principle of CSS Order instablility에 대한 직접 링크" title="The Principle of CSS Order instablility에 대한 직접 링크">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_OaXV" id="using-style-loader">Using style-loader<a href="#using-style-loader" class="hash-link" aria-label="Using style-loader에 대한 직접 링크" title="Using style-loader에 대한 직접 링크">​</a></h3>
<p><code>style-loader</code>가 CSS를 JS module로 변환할때, 동적으로 runtime에서 style tags를 삽입하기때문에 마지막 페이지의 색상은 항상 <code>blue</code>입니다. 따라서, <code>style-loader</code>를 사용하는 것은 CSS modules이 import될 때 CSS의 순서를 안정적으로 일정하게 할 수 있습니다.</p>
<h3 class="anchor anchorWithStickyNavbar_OaXV" id="using-experimentscss-and-mini-css-extract-plugin">Using experiments.css and mini-css-extract-plugin<a href="#using-experimentscss-and-mini-css-extract-plugin" class="hash-link" aria-label="Using experiments.css and mini-css-extract-plugin에 대한 직접 링크" title="Using experiments.css and mini-css-extract-plugin에 대한 직접 링크">​</a></h3>
<table><thead><tr><th>import</th><th>css</th><th>splitChunks chunks</th><th>splitChunks priority</th><th>color</th></tr></thead><tbody><tr><td>experiments</td><td>static</td><td>all</td><td>a = b</td><td>red</td></tr><tr><td>experiments</td><td>static</td><td>all</td><td>a &gt; b</td><td>blue</td></tr><tr><td>experiments</td><td>static</td><td>all</td><td>a &lt; b</td><td>red</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_OaXV" id="첫번째-사례">첫번째 사례<a href="#첫번째-사례" class="hash-link" aria-label="첫번째 사례에 대한 직접 링크" title="첫번째 사례에 대한 직접 링크">​</a></h4>
<ul>
<li><code>static</code>은 entry module이 <code>style.js</code>모듈을 정적으로 import한다는 것을 의미합니다.</li>
<li><code>all</code>은 splitChunks.chunks가 all로 설정되어 있다는 것을 나타내며, 이는 이 패키지 분할 설정이 모든 Chunk에 영향을 미친다는 뜻입니다.</li>
<li><code>=</code>는 두 cacheGroups가 동일  한 우선순위를 갖는다는 것을 의미하며, 최종 페이지에서는 빨간색(red)이 표시됩니다.</li>
</ul>
<div class="language-js codeBlockContainer_VICF theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_crbL"><pre tabindex="0" class="prism-code language-js codeBlock_XKjH thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_ZgUb"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">minSize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">chunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;all&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">cacheGroups</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">a</span><span class="token regex regex-source language-regex special-escape escape">\.</span><span class="token regex regex-source language-regex">css</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">b</span><span class="token regex regex-source language-regex special-escape escape">\.</span><span class="token regex regex-source language-regex">css</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_gClz"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_KJW_" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_plNk"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_PQmj"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://raw.githubusercontent.com/JSerFeng/self-Image-db/main/img/style-chunk-groups.png?raw=true" alt="style-chunk-groups.png" class="img_oK_v"></p>
<p><code>a.css</code>와 <code>b.css</code>는 main chunk로 부터 splitChunks로 분리되었습니다. 동일한 group에 속하  므로 두 모듈은 함께 load될 것입니다.
하지만 함께 load될 때, 순서는 생길 수 밖에 없지만 어떻게동일한 group에서 순서를 결정할 수 있을지 문제가 생깁니다.
정답은 <strong>순서가 보장되지 않는다</strong>입니다.</p>
<p>splitChunk는 모든 모듈을 순회하면서 해당 모듈이 만족하는 모든 CacheGroup 규칙을 찾습니다.
예를 들어,</p>
<ul>
<li><code>a.css</code>는 cacheGroups[&#x27;a&#x27;]에 해당</li>
<li><code>b.css</code>는 cacheGroups[&#x27;b&#x27;]에 해당
그런 다음, 모듈은 해당하는 CacheGroups에 따라 그룹화되며, 각 그룹은 최종적으로 Chunk를 형성합니다.
결과는 아래와 유사합니다.</li>
</ul>
<div class="language-js codeBlockContainer_VICF theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_crbL"><pre tabindex="0" class="prism-code language-js codeBlock_XKjH thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_ZgUb"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> </span><span class="token maybe-class-name">ChunkInfoMap</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">a</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">modules</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;a.css&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">chunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;main&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">cacheGroup</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token spread operator">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token literal-property property">b</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">modules</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;b.css&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">chunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;main&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token literal-property property">cacheGroup</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token spread operator">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup_gClz"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_KJW_" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_plNk"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_PQmj"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>이후 선택된 group을 기반으로 Chunk가 분리됩니다.</p>
<ol>
<li>cacheGroup에서 우선순위가 설정된 경우, 가장 높은 우선순위를 가진 group부터 분리합니다.</li>
<li>Group 내 chunk 개수를 기준으로, <strong>가장 많은 Chunk를 포함하는 group</strong>부터 분리합니다.</li>
<li>Group 내 모듈 크기와 Chunk 수의 곱(크기 x (Chunk 수 - 1))을 기준으로 <strong>가장 큰 크기의 그룹</strong>부터 분리합니다.</li>
<li>모듈이 여러 CacheGroups를 만족하면, <strong>가장 낮은 Index의 그룹</strong>부터 분리합니다.</li>
<li>모듈 수를 기준으로, <strong>가장 많은 모듈을 포함하는 그룹</strong>부터 분리합니다.</li>
<li><strong>module names</strong>으로 정렬합니다.</li>
</ol>
<p>우선순위 code는 <a href="https://github.com/webpack/webpack/blob/3919c844eca394d73ca930e4fc5506fb86e2b094/lib/optimize/SplitChunksPlugin.js#L242" target="_blank" rel="noopener noreferrer">여기</a>서 확인할 수 있습니다.
<img decoding="async" loading="lazy" src="https://raw.githubusercontent.com/JSerFeng/self-Image-db/main/img/compare-entries.png?raw=true" alt="compare-entries.png" class="img_oK_v">
위 예제에서는 우선순위가 설정되지 않았으며, <code>a.css</code>, <code>b.css</code>의 Chunk의 개수도 모두 1개입니다. chunks.size - 1 = 0이고, cacheGroup index도 0이며, module 개수도 동일합니다. 최종적으로 <strong>module names</strong>에 따라 그룹 선택이 이루어집니다.</p>
<p>따라서 a &lt; b이므로, <code>b</code> group이 먼저 split되고 splitting될 때 chunk가 가장 먼저 분리되어 맨 앞으로 위치하게 됩니다.
<img decoding="async" loading="lazy" src="https://raw.githubusercontent.com/JSerFeng/self-Image-db/main/img/before-split.png?raw=true" alt="before-split.png" class="img_oK_v">
다음, <code>a</code> group이 분리되고, 아래와 splitting이 완료되면 아래와 같은 이미지로 분리됩니다.
<img decoding="async" loading="lazy" src="https://raw.githubusercontent.com/JSerFeng/self-Image-db/main/img/splitted.png?raw=true" alt="splitted.png" class="img_oK_v"></p>
<p><code>ChunkGroup</code>의 chunks의 순서에 따라 final page의 chunk가 로드됩니다. 따라서 이 경우 <code>b.css</code>가 먼저 로드되고, <code>a.css</code>가 로드되므로 <strong>빨간색 페이지</strong>가 표시됩니다.</p>
<p>모든 조건이 동일한 상황에서 a와 b 모두 우선순위(priority)가 설정된 경우를 고려해봅시다.</p>
<p>• a의 우선순위가 b보다 높다면, a<strong>가 먼저 분리</strong>되고, 이후 b가 분리되어 <strong>파란색 페이지</strong>가 표시됩니다.
• 반대로, b의 우선순위가 더 높다면, b<strong>가 먼저 분리</strong>되고, 최종적으로 <strong>빨간색 페이지</strong>가 표시됩니다.</p>
<h4 class="anchor anchorWithStickyNavbar_OaXV" id="async">async<a href="#async" class="hash-link" aria-label="async에 대한 직접 링크" title="async에 대한 직접 링크">​</a></h4>
<p>splitChunks.chunks가 <code>async</code>로 설정된 경우, 이는 오직 <code>import()</code>문에 의해 생성된 Chunk만 분리됩니다. 이 경우, <code>a.css</code>와 <code>b.css</code> 모두 entry chunk(main chunk)에 속하므로, splitChunks에 의해 분리되지 않습니다. 따라서 a와 b는 동일한 chunk에 포함되어 이 경우 <strong>순서가 보장됩니다.</strong></p>
<table><thead><tr><th>import</th><th>css</th><th>splitChunks chunks</th><th>splitChunks priority</th><th>color</th></tr></thead><tbody><tr><td>experiments</td><td>static</td><td>async</td><td>a = b</td><td>blue</td></tr><tr><td>experiments</td><td>static</td><td>async</td><td>a &gt; b</td><td>blue</td></tr><tr><td>experiments</td><td>static</td><td>async</td><td>a &lt; b</td><td>blue</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_OaXV" id="dynamic-import">dynamic import<a href="#dynamic-import" class="hash-link" aria-label="dynamic import에 대한 직접 링크" title="dynamic import에 대한 직접 링크">​</a></h4>
<p>css import를 동적(dynamic)으로 변경하면 모든 모듈이 chunk 분할을 거칩니다. 따라서 첫번째 사례와 동일하게 작동합니다.</p>
<table><thead><tr><th>import</th><th>css</th><th>splitChunks chunks</th><th>splitChunks priority</th><th>color</th></tr></thead><tbody><tr><td>experiments</td><td>dynamic</td><td>all</td><td>a = b</td><td>red</td></tr><tr><td>experiments</td><td>dynamic</td><td>all</td><td>a &gt; b</td><td>blue</td></tr><tr><td>experiments</td><td>dynamic</td><td>all</td><td>a &lt; b</td><td>red</td></tr><tr><td>experiments</td><td>dynamic</td><td>async</td><td>a = b</td><td>red</td></tr><tr><td>experiments</td><td>dynamic</td><td>async</td><td>a &gt; b</td><td>blue</td></tr><tr><td>experiments</td><td>dynamic</td><td>async</td><td>a &lt; b</td><td>red</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_OaXV" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Summary에 대한 직접 링크" title="Summary에 대한 직접 링크">​</a></h3>
<p><code>SplitChunks</code>를 사용하여 특정 CSS를 별도의 파일로 분리하면 기존 순서가 변경될 가능성이 높으며, 순서를 자동으로 추론하기 어렵습니다. 이는 스타일 순서 적용이 잘못되는 부작용을 초래할 수 있습니다.</p>
<p>해결책은 CSS load와 style의 적용을 분리하는 것입니다.
<code>style-loader</code>는 JS 실행 중에 CSS 스타일을 mounting하도록 하므로 부분적으로 문제를 해결할 수 있지만, 런타임 오버헤드가 발생하고 splitChunks 및 최소화(minimize)와 같은 최적화 작업이 CSS에는 적용되지 않습니다. 이는 **서버 사이드 렌더링(SSR)**에도 적합하지 않습니다.</p>
<p>Webpack의 <a href="https://github.com/webpack/webpack/issues/14893" target="_blank" rel="noopener noreferrer">experiments.css supporting</a> 이슈에서는 CSS를 import하는 다섯 가지 방법을 언급하며, 이 중 2가지가 문제를 더 잘 해결할 수 있다고 설명합니다:</p>
<ol>
<li>Native CSS Module</li>
</ol>
<div class="language-js codeBlockContainer_VICF theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_crbL"><pre tabindex="0" class="prism-code language-js codeBlock_XKjH thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_ZgUb"><span class="token-line" style="color:#F8F8F2"><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> </span><span class="token imports">stylesheet</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./style.css&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">assert</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;css&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token dom variable" style="color:rgb(189, 147, 249);font-style:italic">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">adoptedStyleSheets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">push</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">stylesheet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup_gClz"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_KJW_" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_plNk"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_PQmj"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>이 방식은 CSS를 load만 하고, style을 적용하기 위해서는 개발자가 수동으로 push해야합니다.
2.  URL 기반 import</p>
<div class="language-js codeBlockContainer_VICF theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_crbL"><pre tabindex="0" class="prism-code language-js codeBlock_XKjH thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_ZgUb"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">URL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./style.css&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token keyword module" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">meta</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup_gClz"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_KJW_" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_plNk"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_PQmj"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>이 방식은 style URL을 단순히 확인하는 방식으로, 네트워크 요청은 개발자가 직접 처리해야합니다.</p>
<p>두 방법 모두 추가 작업이 필요하기 떄문에 기존 <code>import &#x27;./style.css&#x27;;</code> 방식보다 번거롭습니다. 또한, 기존 방식은 명세를 따르지 않는다는 점을 유의해야 합니다.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/eunbae0/dev-store/tree/main/docs/node_js/bundler/webpack/css_order_issue.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_HRRL" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>페이지 편집</a></div><div class="col lastUpdated_rpaX"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="문서 페이지"><a class="pagination-nav__link pagination-nav__link--prev" href="/dev-store/docs/node_js/bundler/rsbuild/toolChain"><div class="pagination-nav__sublabel">이전</div><div class="pagination-nav__label">tools.bundlerChain</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/dev-store/docs/node_js/engine/v8_engine"><div class="pagination-nav__sublabel">다음</div><div class="pagination-nav__label">V8 Engine</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_qPL3 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#서문" class="table-of-contents__link toc-highlight">서문</a></li><li><a href="#간단한-예시" class="table-of-contents__link toc-highlight">간단한 예시</a><ul><li><a href="#splitchunks-설정-후의-변화" class="table-of-contents__link toc-highlight"><code>SplitChunks</code> 설정 후의 변화</a></li><li><a href="#왜-이런-일이-발생할까요" class="table-of-contents__link toc-highlight">왜 이런 일이 발생할까요?</a></li><li><a href="#webpack-css--splitchunks-red-or-blue" class="table-of-contents__link toc-highlight">webpack css + splitChunks: red or blue?</a></li><li><a href="#선행-지식-css-processing-methods-css-처리-방식" class="table-of-contents__link toc-highlight">선행 지식: CSS Processing Methods (CSS 처리 방식)</a></li><li><a href="#splitchunks" class="table-of-contents__link toc-highlight">SplitChunks?</a></li></ul></li><li><a href="#the-principle-of-css-order-instablility" class="table-of-contents__link toc-highlight">The Principle of CSS Order instablility</a><ul><li><a href="#using-style-loader" class="table-of-contents__link toc-highlight">Using style-loader</a></li><li><a href="#using-experimentscss-and-mini-css-extract-plugin" class="table-of-contents__link toc-highlight">Using experiments.css and mini-css-extract-plugin</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/dev-store/docs/fe/intro">FE</a></li><li class="footer__item"><a class="footer__link-item" href="/dev-store/docs/node_js/intro">Node.js</a></li><li class="footer__item"><a class="footer__link-item" href="/dev-store/docs/react_native/intro">RN</a></li><li class="footer__item"><a class="footer__link-item" href="/dev-store/docs/ios/intro">iOS</a></li><li class="footer__item"><a class="footer__link-item" href="/dev-store/docs/android/intro">Android</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://devpluto.tistory.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_mkaX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/eunbae0" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_mkaX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>